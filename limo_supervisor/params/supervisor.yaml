# ===== Supervisor 기본 주기/동작 =====
rate: 2.0                       # Hz, 헬스체크 주기
estop_on_fault: true            # Fault 발생 시 E-Stop 자동 활성화
publish_emergency_cmd: true     # E-Stop 중일 때 /cmd_vel/emergency 0 발행
emergency_cmd_topic: "/cmd_vel/emergency"
emergency_cmd_rate: 20.0        # Hz (E-Stop 중 0 Twist 발행률)

# ===== 필수 노드 존재 체크 (ros master에서 확인) =====
required_nodes:
  - name: "/move_base"
  - name: "/amcl"
  - name: "/ekf_localization"
  - name: "/limo_tf/base_tf_broadcaster"       # 이름은 실제 런치에 맞게
  - name: "/limo_tf/camera_tf_broadcaster"

# ===== 필수 토픽 신선도 체크 (최근 메시지 수신 시각 기준) =====
required_topics:
  - { name: "/scan",               type: "sensor_msgs/LaserScan",      timeout: 0.6 }
  - { name: "/odometry/filtered",  type: "nav_msgs/Odometry",          timeout: 0.6 }
  - { name: "/tf",                 type: "tf2_msgs/TFMessage",         timeout: 1.0 }
  - { name: "/tf_static",          type: "tf2_msgs/TFMessage",         timeout: 5.0 }

# ===== TF 일관성 체크 (lookup_transform 성공 여부) =====
tf_checks:
  - { parent: "map",        child: "odom",       timeout: 0.3 }
  - { parent: "odom",       child: "base_link",  timeout: 0.3 }
  - { parent: "base_link",  child: "base_laser", timeout: 0.3 }
  - { parent: "base_link",  child: "camera_link",timeout: 0.3 }

# ===== 배터리(선택) : 없으면 무시됨 =====
battery:
  topic: "/battery_state"        # sensor_msgs/BatteryState or custom(전압만 있으면 OK)
  min_voltage: 11.0              # 경고
  critical_voltage: 10.6         # 치명 → E-Stop(옵션)
  timeout: 5.0

# ===== 외부에서 E-Stop 해제 허용 여부 =====
allow_estop_clear: true

# ===== 상태 토픽 =====
topics:
  state: "/supervisor/state"         # String
  heartbeat: "/supervisor/heartbeat" # String ("OK"|"FAULT" 등)
  estop_flag: "/e_stop"              # std_msgs/Bool
